generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Testimonial {
  id        String   @id @default(cuid())
  quote     String
  author    String
  company   String?
  rating    Int      @default(5)
  result    String?
  service   String
  deleted   Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Page {
  id           String         @id @default(cuid())
  slug         String         @unique
  title        String
  content      String
  published    Boolean        @default(false)
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  pageBlocks   PageBlock[]
  schemaMarkup SchemaMarkup[]
  seo          SeoMetadata?

  @@index([slug])
}

model SeoMetadata {
  id              String  @id @default(cuid())
  metaTitle       String?
  metaDescription String?
  canonicalUrl    String?
  robotsIndex     Boolean @default(true)
  robotsFollow    Boolean @default(true)
  focusKeyword    String?
  ogTitle         String?
  ogDescription   String?
  ogImage         String?
  pageId          String  @unique
  page            Page    @relation(fields: [pageId], references: [id], onDelete: Cascade)
}

model SchemaMarkup {
  id       String @id @default(cuid())
  type     String
  jsonData String
  pageId   String
  page     Page   @relation(fields: [pageId], references: [id], onDelete: Cascade)
}

model Redirect {
  id         String   @id @default(cuid())
  oldUrl     String   @unique
  newUrl     String
  statusCode Int      @default(301)
  createdAt  DateTime @default(now())
  active     Boolean  @default(true)

  @@index([oldUrl])
}

model Media {
  id         String   @id @default(cuid())
  filename   String
  url        String
  altText    String?
  mimeType   String
  size       Int
  width      Int?
  height     Int?
  focalPoint String?
  variants   String?
  createdAt  DateTime @default(now())
}

model Block {
  id         String      @id @default(cuid())
  name       String
  type       String
  content    String
  styles     String?
  isGlobal   Boolean     @default(false)
  category   String?
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  pageBlocks PageBlock[]
}

model PageBlock {
  id        String  @id @default(cuid())
  pageId    String
  blockId   String
  order     Int
  overrides String?
  hidden    String?
  block     Block   @relation(fields: [blockId], references: [id], onDelete: Cascade)
  page      Page    @relation(fields: [pageId], references: [id], onDelete: Cascade)

  @@unique([pageId, blockId])
  @@index([pageId])
}

model ABTest {
  id         String    @id @default(cuid())
  name       String
  pageSlug   String
  elementId  String?
  variantA   String
  variantB   String
  trafficB   Int       @default(50)
  goal       String?
  goalTarget String?
  status     String    @default("draft")
  startDate  DateTime?
  endDate    DateTime?
  results    String?
  winner     String?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  @@index([pageSlug, status])
}

model DynamicVariable {
  id          String   @id @default(cuid())
  key         String   @unique
  value       String
  autoUpdate  Boolean  @default(false)
  formula     String?
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Interlink {
  id           String   @id @default(cuid())
  sourcePageId String
  targetPageId String
  anchorText   String
  context      String?
  score        Float    @default(0)
  status       String   @default("suggested")
  createdAt    DateTime @default(now())

  @@index([sourcePageId])
  @@index([targetPageId])
}

model User {
  id            String   @id @default(cuid())
  name          String?
  email         String   @unique
  password      String
  role          String   @default("user")
  driveFolderId String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Project {
  id          String   @id @default(cuid())
  title       String
  client      String
  category    String
  year        String
  description String
  results     String
  tags        String
  image       String
  color       String   @default("#FACC15")
  showOnHome  Boolean  @default(false)
  deleted     Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Client {
  id                   String   @id @default(cuid())
  name                 String
  logo                 String?
  url                  String?
  description          String?
  socials              String?
  showInSuccessStories Boolean  @default(false)
  deleted              Boolean  @default(false)
  order                Int      @default(0)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
}

model Service {
  id           String   @id @default(cuid())
  slug         String   @unique
  title        String
  uvpTitle     String?
  uvpSubtitle  String?
  ctaText      String?
  description  String
  clientCount  Int      @default(0)
  stats        String?
  benefits     String?
  faq          String?
  testimonials String?
  comparison   String?
  order        Int      @default(0)
  deleted      Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model SiteConfig {
  id        String   @id @default(cuid())
  key       String   @unique
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BlogPost {
  id              String   @id @default(cuid())
  slug            String   @unique
  title           String
  content         String
  excerpt         String?
  image           String?
  author          String?
  category        String?
  date            String?
  readTime        String?
  featured        Boolean  @default(false)
  tags            String?
  published       Boolean  @default(false)
  deleted         Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  metaDescription String?
  metaTitle       String?
}

model Faq {
  id        String   @id @default(cuid())
  question  String
  answer    String
  order     Int      @default(0)
  category  String?
  deleted   Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ConsentLog {
  id             String   @id @default(cuid())
  email          String
  ipAddress      String?
  userAgent      String?
  consentType    String
  consentVersion String
  consentText    String
  accepted       Boolean  @default(true)
  createdAt      DateTime @default(now())

  @@index([email])
}

model Lead {
  id        String   @id @default(cuid())
  name      String?
  email     String
  company   String?
  website   String?
  phone     String?
  message   String?
  source    String
  status    String   @default("new")
  budget    String?
  services  String?
  ipAddress String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
  @@index([status])
}
